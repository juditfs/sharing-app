appId: host.exp.exponent
---
# This is a solid "Smoke Test" that doesn't trigger email rate limits.
# It ensures the app launches, navigation works, and the main screen renders.

- openLink: exp://127.0.0.1:8081 # Open the app in Expo Go

# Wait for Expo Go to bundle by matching ANY possible screen state we might be left in
- extendedWaitUntil:
    visible: ".*(Welcome to Sharene|Enter an email|Check your email|Created Links|Encrypted Photo Sharing).*"
    timeout: 30000

# 1. If we are stuck halfway through the login flow, back out to Welcome
- runFlow:
    when:
      visible: "← Back"
    commands:
      - tapOn: "← Back"
- runFlow:
    when:
      visible: "← Back"
    commands:
      - tapOn: "← Back"

# 2. If we are fully signed in, Sign Out
- runFlow:
    when:
      visible: "Sign Out"
    commands:
      - tapOn: "Sign Out"


- assertVisible: "Welcome to Sharene"
- tapOn: "Get Started"

- assertVisible: "Enter an email to get started!"
- tapOn: "Skip for now"

# We should now be logged in (either on Upload or Dashboard screen).
# The "Sign Out" button is always visible in the header.
- extendedWaitUntil:
    visible: "Sign Out"
    timeout: 10000
- assertVisible: "Sign Out"
